const MINI_APP_URL = process.env.MINI_APP_URL || "https://your-domain.com";

const FAQ_SECTIONS = {
  main: {
    text:
      `‚ùì <b>FAQ ‚Äî Padel GO</b>\n\n` +
      `–í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–∑–¥–µ–ª:\n\n` +
      `üéæ –û–±—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã\n` +
      `üìä –†–µ–π—Ç–∏–Ω–≥ –∏ —É—Ä–æ–≤–Ω–∏\n` +
      `üéæ –ú–∞—Ç—á–∏\n` +
      `üìù –°—á—ë—Ç –∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ\n` +
      `üèÖ –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è –∏ XP\n` +
      `ü§ñ –ë–æ—Ç\n` +
      `‚ùó –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã`,
    buttons: [
      [{ text: "üéæ –û–±—â–∏–µ", callback_data: "faq_general" }, { text: "üìä –†–µ–π—Ç–∏–Ω–≥", callback_data: "faq_rating" }],
      [{ text: "üéæ –ú–∞—Ç—á–∏", callback_data: "faq_matches" }, { text: "üìù –°—á—ë—Ç", callback_data: "faq_score" }],
      [{ text: "üèÖ –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è", callback_data: "faq_achievements" }, { text: "ü§ñ –ë–æ—Ç", callback_data: "faq_bot" }],
      [{ text: "‚ùó –ü—Ä–æ–±–ª–µ–º—ã", callback_data: "faq_problems" }],
      [{ text: "üì± –û—Ç–∫—Ä—ã—Ç—å FAQ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏", web_app: { url: MINI_APP_URL } }],
    ],
  },
  general: {
    text:
      `üéæ <b>–û–±—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã</b>\n\n` +
      `<b>–ß—Ç–æ —Ç–∞–∫–æ–µ Padel GO?</b>\n` +
      `Telegram Mini App –¥–ª—è –ø–∞–¥–µ–ª-—Å–æ–æ–±—â–µ—Å—Ç–≤–∞ –ë–µ–ª–∞—Ä—É—Å–∏ ‚Äî –º–∞—Ç—á–∏, —Ä–µ–π—Ç–∏–Ω–≥, —Ç—É—Ä–Ω–∏—Ä—ã, –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è.\n\n` +
      `<b>–ö–∞–∫ –Ω–∞—á–∞—Ç—å?</b>\n` +
      `@PadelGoBY_bot ‚Üí /start ‚Üí ¬´–û—Ç–∫—Ä—ã—Ç—å Padel GO¬ª ‚Üí –æ–Ω–±–æ—Ä–¥–∏–Ω–≥ (–≥–æ—Ä–æ–¥, —Ä–µ–π—Ç–∏–Ω–≥, –ø—Ä–æ—Ñ–∏–ª—å).\n\n` +
      `<b>–≠—Ç–æ –±–µ—Å–ø–ª–∞—Ç–Ω–æ?</b>\n` +
      `–î–∞, –ø–æ–ª–Ω–æ—Å—Ç—å—é –±–µ—Å–ø–ª–∞—Ç–Ω–æ.`,
  },
  rating: {
    text:
      `üìä <b>–†–µ–π—Ç–∏–Ω–≥ –∏ —É—Ä–æ–≤–Ω–∏</b>\n\n` +
      `<b>–°—Ç–∞—Ä—Ç–æ–≤—ã–π —Ä–µ–π—Ç–∏–Ω–≥:</b>\n` +
      `‚Ä¢ –ò–º–ø–æ—Ä—Ç –∏–∑ Raceto/Playtomic\n` +
      `‚Ä¢ –ò–ª–∏ –∞–Ω–∫–µ—Ç–∞ –∏–∑ 6 –≤–æ–ø—Ä–æ—Å–æ–≤ (1000‚Äì2500)\n\n` +
      `<b>–°–∏—Å—Ç–µ–º–∞ Elo:</b>\n` +
      `–°—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥ –∫–æ–º–∞–Ω–¥ ‚Üí –æ–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç ‚Üí –∏–∑–º–µ–Ω–µ–Ω–∏–µ.\n\n` +
      `<b>K-—Ñ–∞–∫—Ç–æ—Ä:</b>\n` +
      `‚Ä¢ 0‚Äì10 –º–∞—Ç—á–µ–π: K=50 (–∫–∞–ª–∏–±—Ä–æ–≤–∫–∞)\n` +
      `‚Ä¢ 11‚Äì30: K=40 (–ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–∞—è)\n` +
      `‚Ä¢ 31+: K=32 (—Å—Ç–∞–±–∏–ª—å–Ω—ã–π)\n\n` +
      `<b>–ú–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã:</b>\n` +
      `‚Ä¢ –†–∞–∑–≥—Ä–æ–º 6-0/6-1: √ó1.15\n` +
      `‚Ä¢ –¢–∞–π–±—Ä–µ–π–∫ 7-6: √ó0.90\n` +
      `‚Ä¢ 3 —Å–µ—Ç–∞: √ó1.10\n\n` +
      `<b>–£—Ä–æ–≤–Ω–∏:</b>\n` +
      `D (0‚Äì2500) –ù–æ–≤–∏—á–æ–∫\n` +
      `C (2501‚Äì3500) –õ—é–±–∏—Ç–µ–ª—å\n` +
      `B (3501‚Äì4500) –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π\n` +
      `A (4501‚Äì5000) –°–∏–ª—å–Ω—ã–π`,
  },
  matches: {
    text:
      `üéæ <b>–ú–∞—Ç—á–∏</b>\n\n` +
      `<b>–°–æ–∑–¥–∞—Ç—å:</b> ¬´+ –°–æ–∑–¥–∞—Ç—å –º–∞—Ç—á¬ª –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∏–ª–∏ /create –≤ –±–æ—Ç–µ\n\n` +
      `<b>–ù–∞–π—Ç–∏:</b> –≤–∫–ª–∞–¥–∫–∞ ¬´–ú–∞—Ç—á–∏¬ª –∏–ª–∏ /find –≤ –±–æ—Ç–µ\n\n` +
      `<b>–ó–∞–ø–∏—Å–∞—Ç—å —Å—ã–≥—Ä–∞–Ω–Ω—ã–π:</b> ¬´–ó–∞–ø–∏—Å–∞—Ç—å —Å—á—ë—Ç¬ª ‚Üí –¥–∞—Ç–∞ –≤ –ø—Ä–æ—à–ª–æ–º + 3 –∏–≥—Ä–æ–∫–∞\n\n` +
      `<b>–°—Ç–∞—Ç—É—Å—ã:</b>\n` +
      `üü° –ù–∞–±–æ—Ä ‚Üí üü¢ –°–æ–±—Ä–∞–Ω ‚Üí üîµ –í –ø—Ä–æ—Ü–µ—Å—Å–µ ‚Üí üü† –û–∂–∏–¥–∞–µ—Ç —Å—á—ë—Ç ‚Üí üü£ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ ‚Üí ‚úÖ –ó–∞–≤–µ—Ä—à—ë–Ω\n\n` +
      `<b>–í—ã–π—Ç–∏:</b> ¬´–ü–æ–∫–∏–Ω—É—Ç—å –º–∞—Ç—á¬ª –∏–ª–∏ /cancel`,
  },
  score: {
    text:
      `üìù <b>–°—á—ë—Ç –∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ</b>\n\n` +
      `<b>–í–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞:</b>\n` +
      `1. –†–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç–µ 4 –∏–≥—Ä–æ–∫–æ–≤ –ø–æ –∫–æ–º–∞–Ω–¥–∞–º\n` +
      `2. –í–≤–µ–¥–∏—Ç–µ —Å—á—ë—Ç –ø–æ —Å–µ—Ç–∞–º\n` +
      `3. –ü—Ä–∏ 7-6 ‚Äî –ø–æ–ª–µ —Ç–∞–π–±—Ä–µ–π–∫–∞\n` +
      `4. –û—Ç–ø—Ä–∞–≤—å—Ç–µ\n\n` +
      `<b>–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ:</b>\n` +
      `–õ—é–±–æ–π –∏–∑ —Å–æ–ø–µ—Ä–Ω–∏–∫–æ–≤ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç —á–µ—Ä–µ–∑ –±–æ—Ç–∞ –∏–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.\n\n` +
      `<b>–ê–≤—Ç–æ–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ:</b>\n` +
      `–ß–µ—Ä–µ–∑ 7 –¥–Ω–µ–π, –µ—Å–ª–∏ –Ω–∏–∫—Ç–æ –Ω–µ –æ—Å–ø–æ—Ä–∏–ª.\n\n` +
      `<b>–û—Å–ø–∞—Ä–∏–≤–∞–Ω–∏–µ:</b>\n` +
      `–ù–∞–∂–º–∏—Ç–µ ¬´–û—Å–ø–æ—Ä–∏—Ç—å¬ª ‚Üí –ø—Ä–µ–¥–ª–æ–∂–∏—Ç–µ —Å–≤–æ–π –≤–∞—Ä–∏–∞–Ω—Ç.`,
  },
  achievements: {
    text:
      `üèÖ <b>–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è –∏ XP</b>\n\n` +
      `23 –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –ø–æ 6 –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º:\n\n` +
      `üéæ <b>–ú–∞—Ç—á–∏:</b> 1/10/50/100 –º–∞—Ç—á–µ–π, 30 –∑–∞ –º–µ—Å—è—Ü\n` +
      `‚ö° <b>–ü–æ–±–µ–¥—ã:</b> —Å–µ—Ä–∏–∏ 3/5/10, –∫–∞–º–±—ç–∫, —Å—É—Ö–∞—Ä—å 6-0, –≤–∏–Ω—Ä–µ–π—Ç 70%\n` +
      `üìä <b>–†–µ–π—Ç–∏–Ω–≥:</b> +50/+100 –∑–∞ –Ω–µ–¥–µ–ª—é, 1500/1800/2000, —É–±–∏–π—Ü–∞ –≥–∏–≥–∞–Ω—Ç–æ–≤\n` +
      `ü§ù <b>–°–æ—Ü–∏–∞–ª—å–Ω—ã–µ:</b> 5/20 –ø–∞—Ä—Ç–Ω—ë—Ä–æ–≤, 10 –º–∞—Ç—á–µ–π —Å–æ–∑–¥–∞–Ω–æ, –≤—Å–µ –≥–æ—Ä–æ–¥–∞, –≤—Å–µ –ø–ª–æ—â–∞–¥–∫–∏\n` +
      `üèÜ <b>–¢—É—Ä–Ω–∏—Ä—ã:</b> 1/3 —Ç—É—Ä–Ω–∏—Ä–∞, –ø–æ–±–µ–¥–∞\n\n` +
      `<b>XP —É—Ä–æ–≤–Ω–∏:</b>\n` +
      `üå± –ù–æ–≤–∏—á–æ–∫ ‚Üí üåø –ê–∫—Ç–∏–≤–∏—Å—Ç (200) ‚Üí üå≥ –†–µ–≥—É–ª—è—Ä (500) ‚Üí ‚≠ê –í–µ—Ç–µ—Ä–∞–Ω (1000) ‚Üí üíé –ú–∞—Å—Ç–µ—Ä (2000) ‚Üí üëë –õ–µ–≥–µ–Ω–¥–∞ (3500)`,
  },
  bot: {
    text:
      `ü§ñ <b>–ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞</b>\n\n` +
      `/me ‚Äî –ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞\n` +
      `/top ‚Äî –¢–æ–ø-10 –∏–≥—Ä–æ–∫–æ–≤\n` +
      `/matches ‚Äî –ú–æ–∏ –ø—Ä–µ–¥—Å—Ç–æ—è—â–∏–µ –º–∞—Ç—á–∏\n` +
      `/find ‚Äî –ù–∞–π—Ç–∏ –¥–æ—Å—Ç—É–ø–Ω—ã–π –º–∞—Ç—á\n` +
      `/create ‚Äî –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –º–∞—Ç—á\n` +
      `/cancel ‚Äî –í—ã–π—Ç–∏ –∏–∑ –º–∞—Ç—á–∞\n` +
      `/faq ‚Äî –≠—Ç–æ—Ç FAQ\n` +
      `/help ‚Äî –°–ø—Ä–∞–≤–∫–∞\n\n` +
      `<b>–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:</b>\n` +
      `‚è∞ –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è\n` +
      `üéâ –ú–∞—Ç—á —Å–æ–±—Ä–∞–Ω\n` +
      `üìä –†–µ–π—Ç–∏–Ω–≥\n` +
      `üèÖ –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è\n` +
      `üìã –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–∞—è —Å–≤–æ–¥–∫–∞`,
  },
  problems: {
    text:
      `‚ùó <b>–ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã</b>\n\n` +
      `<b>–†–µ–π—Ç–∏–Ω–≥ –Ω–µ –∏–∑–º–µ–Ω–∏–ª—Å—è?</b>\n` +
      `‚Ä¢ –°—á—ë—Ç –Ω–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω\n` +
      `‚Ä¢ –î—Ä—É–∂–µ—Å–∫–∏–π –º–∞—Ç—á (–Ω–µ –º–µ–Ω—è–µ—Ç —Ä–µ–π—Ç–∏–Ω–≥)\n` +
      `‚Ä¢ –ñ–¥–∏—Ç–µ –¥–æ 7 –¥–Ω–µ–π\n\n` +
      `<b>–ù–µ –ø—Ä–∏—Ö–æ–¥—è—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è?</b>\n` +
      `–ë–æ—Ç –Ω–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω? –ù–∞–ø–∏—à–∏—Ç–µ /start\n\n` +
      `<b>–£–¥–∞–ª–∏—Ç—å –∞–∫–∫–∞—É–Ω—Ç?</b>\n` +
      `–ù–∞–ø–∏—à–∏—Ç–µ –≤ @PadelMateChat`,
  },
};

async function faqCommand(bot, msg) {
  const chatId = msg.chat.id;
  const section = FAQ_SECTIONS.main;

  await bot.sendMessage(chatId, section.text, {
    parse_mode: "HTML",
    reply_markup: { inline_keyboard: section.buttons },
  });
}

async function handleFaqCallback(bot, query) {
  const chatId = query.message.chat.id;
  const messageId = query.message.message_id;
  const sectionKey = query.data.replace("faq_", "");
  const section = FAQ_SECTIONS[sectionKey];

  if (!section) {
    await bot.answerCallbackQuery(query.id, { text: "–†–∞–∑–¥–µ–ª –Ω–µ –Ω–∞–π–¥–µ–Ω" });
    return;
  }

  const backButton = [{ text: "‚Üê –ù–∞–∑–∞–¥ –∫ —Ä–∞–∑–¥–µ–ª–∞–º", callback_data: "faq_back" }];

  try {
    await bot.editMessageText(section.text, {
      chat_id: chatId,
      message_id: messageId,
      parse_mode: "HTML",
      reply_markup: {
        inline_keyboard: section.buttons || [backButton],
      },
    });
  } catch (e) {
    // Message not modified ‚Äî ignore
  }
  await bot.answerCallbackQuery(query.id);
}

async function handleFaqBack(bot, query) {
  const chatId = query.message.chat.id;
  const messageId = query.message.message_id;
  const section = FAQ_SECTIONS.main;

  try {
    await bot.editMessageText(section.text, {
      chat_id: chatId,
      message_id: messageId,
      parse_mode: "HTML",
      reply_markup: { inline_keyboard: section.buttons },
    });
  } catch (e) {
    // ignore
  }
  await bot.answerCallbackQuery(query.id);
}

module.exports = { faqCommand, handleFaqCallback, handleFaqBack };
